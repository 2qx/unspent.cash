{"version":3,"file":"UtxoSection.86dd16ff.js","sources":["../../../../../../src/lib/images/arrow_split.svg","../../../../../../src/lib/images/copy.svg","../../../../../../src/lib/UtxoSection.svelte"],"sourcesContent":["export default \"__VITE_ASSET__f8bbe693__\"","export default \"__VITE_ASSET__5bf06bc3__\"","<script>\n\timport { beforeUpdate } from 'svelte';\n\timport { Perpetuity } from '@unspent/phi';\n\timport { _ } from 'svelte-i18n';\n\timport arrow_split from '$lib/images/arrow_split.svg';\n\timport lock_clock from '$lib/images/lock_clock.svg';\n\timport copy from '$lib/images/copy.svg';\n\timport { toast } from '@zerodevx/svelte-toast';\n\timport CopyToClipboard from '$lib/CopyToClipboard.svelte';\n\n\texport let receiptAddress = '';\n\tlet utxos = [];\n\tlet contract;\n\tlet isLoading = true;\n\n\tlet executedSuccess = false;\n\tlet txid = '';\n\tlet executeError = '';\n\n\tlet curHeight = -1;\n\tlet now = Date.now();\n\n\tbeforeUpdate(async () => {\n\t\tif (receiptAddress) {\n\t\t\tif (!contract) {\n\t\t\t\tcontract = new Perpetuity(4383, receiptAddress, 1500, 96);\n\t\t\t\tif (contract) {\n\t\t\t\t\tawait loadSeries();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\tconst execute = async (utxo) => {\n\t\texecutedSuccess = false;\n\t\ttry {\n\t\t\ttxid = await contract.execute(receiptAddress, undefined, [utxo]);\n\t\t\texecutedSuccess = true;\n\t\t\texecuteError = '';\n\t\t} catch (e) {\n\t\t\texecuteError = e;\n\t\t}\n\t};\n\n\tconst loadSeries = async () => {\n\t\tutxos = await contract.getUtxos();\n\t\tcurHeight = await contract.provider.getBlockHeight();\n\t\tutxos = utxos.sort((a, b) => a.height - b.height);\n\t\tutxos = utxos.map((u) => {\n\t\t\tlet waitBlocks = u.height + 4383 - curHeight;\n\t\t\treturn {\n\t\t\t\t...u,\n\t\t\t\testimateUnlockDate: new Date(now + waitBlocks * 600000).toLocaleString(),\n\t\t\t\twaitBlocks: waitBlocks\n\t\t\t};\n\t\t});\n\t\tisLoading = false;\n\t};\n</script>\n\n<section>\n\t{#if utxos && utxos.length > 0}\n\t\t{txid}\n\t\t{executeError}\n\t\t{#each utxos as op}\n\t\t\t<table>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t{#if curHeight > 0 && op.waitBlocks > 0}\n\t\t\t\t\t\t\t<img src={lock_clock} alt={$_('ok')} />\n\t\t\t\t\t\t\t<b>{op.waitBlocks}</b>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</td>\n\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<b>{op.satoshis.toLocaleString()}</b> sats <br />\n\t\t\t\t\t\t<i>\n\t\t\t\t\t\t\t{(Number(op.satoshis) / 100000000).toLocaleString(undefined, {\n\t\t\t\t\t\t\t\tminimumSignificantDigits: 6\n\t\t\t\t\t\t\t})} BCH\n\t\t\t\t\t\t</i>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t{#if op.waitBlocks < 0}\n\t\t\t\t\t\t\t<button on:click={async () => execute(op)}>\n\t\t\t\t\t\t\t\t<img src={arrow_split} />\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<button on:click={async () => execute(op)}>\n\t\t\t\t\t\t\t\t<img src={arrow_split} />\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</td>\n\t\t\t\t\t<td colspan=\"3\" style=\"line-break: anywhere;\">\n\t\t\t\t\t\t{#if curHeight > 0 && op.waitBlocks > 0}\n\t\t\t\t\t\t\t<p>{op.estimateUnlockDate}</p>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t<b>{(op.satoshis / 96n).toLocaleString()}</b> sats <br />\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t{/each}\n\t{:else if !isLoading && utxos.length == 0}\n\t\t{#if contract}\n\t\t\t<table width=\"300px\">\n\t\t\t\t<tr>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t<img src={lock_clock} alt={$_('ok')} />\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<p><b>0 â‚¿</b></p>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td style=\"line-break:anywhere;\" colspan=\"2\">\n\t\t\t\t\t\t<img src={copy} />\n\t\t\t\t\t\t<CopyToClipboard\n\t\t\t\t\t\t\ton:copy={() => toast.push('ðŸ“‹ðŸ—¸')}\n\t\t\t\t\t\t\ttext={contract.getAddress()}\n\t\t\t\t\t\t\tlet:copy\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\"action\">\n\t\t\t\t\t\t\t\t<button class=\"styled\" on:click={copy}>\n\t\t\t\t\t\t\t\t\t{contract.getAddress()}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</CopyToClipboard>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t{/if}\n\t\t<br />\n\t\t<br />\n\t\t<p>\n\t\t\t<img width=\"300px\" src=\"/h/13.svg\" alt=\"send bitcoin\" />\n\t\t</p>\n\t{:else}\n\t\t<progress id=\"progress-bar\" aria-label=\"Content loadingâ€¦\" />\n\t{/if}\n</section>\n\n<style>\n\tdiv {\n\t\tmax-width: 600px;\n\t}\n\n\ttable {\n\t\tborder: 1mm ridge rgba(211, 220, 50, 0.6);\n\t}\n\ttable tr td {\n\t\tborder-width: 1px;\n\t\tpadding: 15px;\n\t\tborder-style: inset;\n\t\tborder-color: gray;\n\t\tbackground-color: white;\n\t}\n\n\tsection {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tflex: 0.6;\n\t\tline-break: normal;\n\t}\n\n  .styled {\n\t\tborder-color: #000;\n\t\tfont-size: 1rem;\n\t\ttext-align: center;\n\t\tcolor: #000;\n\t\tborder-radius: 10px;\n\t\tbackground-color: #fff3e2;\n\t\tfont-weight: 700;\n    padding: 5px;\n    box-shadow:\n    inset 2px 2px 3px rgba(255, 255, 255, 0.6),\n    inset -2px -2px 3px rgba(0, 0, 0, 0.6);\n\t}\n\n\t.styled:hover {\n\t\tbackground-color: rgb(255, 184, 54);\n\t}\n\n\t.styled:active {\n\t\tbox-shadow: inset -2px -2px 3px rgba(255, 255, 255, 0.6), inset 2px 2px 3px rgba(0, 0, 0, 0.6);\n\t}\n</style>\n"],"names":["arrow_split","copy","insert_hydration","target","progress","anchor","ctx","create_if_block_5","br0","br1","p","i","lock_clock","attr","img0","img0_src_value","img0_alt_value","img1","img1_src_value","table","append_hydration","tr0","td0","p0","td1","tr1","td2","current","dirty","copytoclipboard_changes","t_value","div","button","is_function","set_data","t","t1_value","img","img_src_value","img_alt_value","b","t1","t4_value","t9_value","if_block0","create_if_block_3","create_if_block_2","if_block2","create_if_block_1","b0","td3","b1","t4","t9","section","receiptAddress","$$props","utxos","contract","isLoading","executedSuccess","txid","executeError","curHeight","now","beforeUpdate","Perpetuity","loadSeries","execute","utxo","$$invalidate","e","a","u","waitBlocks","click_handler","op","click_handler_1","toast"],"mappings":"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"}