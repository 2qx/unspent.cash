{"version":3,"file":"UtxoSection.49042ae0.js","sources":["../../../../../../src/lib/images/arrow_split.svg","../../../../../../src/lib/UtxoSection.svelte"],"sourcesContent":["export default \"__VITE_ASSET__f8bbe693__\"","<script>\n\timport { beforeUpdate } from 'svelte';\n\timport { Perpetuity } from '@unspent/phi';\n\timport { _ } from 'svelte-i18n';\n\timport arrow_split from '$lib/images/arrow_split.svg';\n\timport lock_clock from '$lib/images/lock_clock.svg';\n\n\texport let receiptAddress = '';\n\tlet utxos = [];\n\tlet contract;\n\tlet isLoading = true;\n\n\tlet executedSuccess = false;\n\tlet txid = '';\n\tlet executeError = '';\n\n\tlet curHeight = -1;\n\tlet now = Date.now();\n\n\n\n\tbeforeUpdate(async () => {\n\t\tif (receiptAddress) {\n\t\t\tif (!contract) {\n\t\t\t\tcontract = new Perpetuity(4383, receiptAddress, 1500, 96);\n\t\t\t\tif (contract) {\n\t\t\t\t\tawait loadSeries();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\tconst execute = async (utxo) => {\n\t\texecutedSuccess = false;\n\t\ttry {\n\t\t\ttxid = await contract.execute(receiptAddress, undefined, [utxo]);\n\t\t\texecutedSuccess = true;\n\t\t\texecuteError = '';\n\t\t} catch (e) {\n\t\t\texecuteError = e;\n\t\t}\n\t};\n\n\tconst loadSeries = async () => {\n\t\tutxos = await contract.getUtxos();\n\t\tcurHeight = await contract.provider.getBlockHeight();\n    utxos = utxos.sort((a, b) => a.height - b.height);\n\t\tutxos = utxos.map((u) => {\n\t\t\tlet waitBlocks = u.height + 4383 - curHeight;\n\t\t\treturn {\n\t\t\t\t...u,\n\t\t\t\testimateUnlockDate: new Date(now + waitBlocks * 600000).toLocaleString(),\n\t\t\t\twaitBlocks: waitBlocks\n\t\t\t};\n\t\t});\n\t\tisLoading = false;\n\t};\n</script>\n\n<section>\n\t{#if utxos && utxos.length > 0}\n  { txid }\n  { executeError }\n\t\t{#each utxos as op}\n\t\t\t<table>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t{#if curHeight > 0 && op.waitBlocks > 0}\n\t\t\t\t\t\t\t<img src={lock_clock} alt={$_('ok')} />\n\t\t\t\t\t\t\t<b>{op.waitBlocks}</b>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</td>\n\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<b>{op.satoshis.toLocaleString()}</b> sats <br />\n\t\t\t\t\t\t<i>\n\t\t\t\t\t\t\t{(Number(op.satoshis) / 100000000).toLocaleString(undefined, {\n\t\t\t\t\t\t\t\tminimumSignificantDigits: 6\n\t\t\t\t\t\t\t})} BCH\n\t\t\t\t\t\t</i>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t{#if op.waitBlocks < 0}\n\t\t\t\t\t\t\t<button on:click={async () => execute(op)}>\n\t\t\t\t\t\t\t\t<img src={arrow_split} />\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<button on:click={async () => execute(op)}>\n\t\t\t\t\t\t\t\t<img src={arrow_split} />\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t{#if curHeight > 0 && op.waitBlocks > 0}\n\t\t\t\t\t\t\t<p>{op.estimateUnlockDate}</p>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</td>\n\t\t\t\t\t<td colspan=\"3\" style=\"line-break: anywhere;\">\n\t\t\t\t\t\t{op.txid}:{op.vout}\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t{/each}\n\t{:else if !isLoading && utxos.length == 0}\n\t\t0 sats\n\t{:else}\n\t\t<progress id=\"progress-bar\" aria-label=\"Content loadingâ€¦\" />\n\t{/if}\n</section>\n\n<style>\n\tdiv {\n\t\tmax-width: 600px;\n\t}\n\n\ttable {\n\t\tborder: 1mm ridge rgba(211, 220, 50, 0.6);\n\t}\n\ttable tr td {\n\t\tborder-width: 1px;\n\t\tpadding: 15px;\n\t\tborder-style: inset;\n\t\tborder-color: gray;\n\t\tbackground-color: white;\n\t}\n\n\tsection {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tflex: 0.6;\n\t\tline-break: normal;\n\t}\n</style>\n"],"names":["arrow_split","insert_hydration","target","progress","anchor","ctx","i","t1_value","lock_clock","attr","img","img_src_value","img_alt_value","b","dirty","set_data","t1","button","t_value","p","t","t4_value","t9_value","t11_value","if_block0","create_if_block_3","create_if_block_2","if_block2","create_if_block_1","table","append_hydration","tr0","td0","td1","br","tr1","td2","td3","t4","t9","t11","create_if_block","create_if_block_4","section","receiptAddress","$$props","utxos","contract","isLoading","executedSuccess","txid","executeError","curHeight","now","beforeUpdate","Perpetuity","loadSeries","execute","utxo","$$invalidate","e","a","u","waitBlocks","click_handler","op","click_handler_1"],"mappings":"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"}